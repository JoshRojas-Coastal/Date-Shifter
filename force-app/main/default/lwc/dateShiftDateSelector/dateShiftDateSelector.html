<template>
	<template if:true={loading}>
		<lightning-spinner alternative-text="Retrieving org object list ..."></lightning-spinner>
	</template>
	<p class="slds-p-horizontal_medium">
		This tool shifts all <code>Date</code> and <code>DateTime</code> fields in the objects you specify by the same amount of time so that dates that lined up logically when
		you first showed the demo can stay lined up when you do your demo again weeks or months later. To determine the amount of the shift, the tool examines the most recent
		value in a <code>DateTime</code> field of the object that you choose below and calculates how much time separates it from the date and time you choose in the picker. Dates
		can be shifted backwards as well as forwards.
	</p>
	<lightning-layout>
		<lightning-layout-item size="6" padding="around-medium">
			<lightning-combobox
				name="object"
				label="Select an Object on Which to Base the Date Shift"
				options={orgObjectList}
				value={objectApiName}
				placeholder="Select an object"
				disabled={objectSelectorDisabled}
				onchange={handleObjectChange}
			>
			</lightning-combobox>
			<lightning-combobox
				name="field"
				data-id="field"
				label="Select a DateTime field within the Object"
				options={fieldList}
				value={fieldApiName}
				placeholder="Select a field"
				disabled={fieldSelectorDisabled}
				onchange={handleFieldChange}
				class="slds-p-top_medium"
			>
			</lightning-combobox>
			<div class="slds-p-top_medium">
				<template if:true={showSaveSettingsButton}>
					<lightning-button
						label="Save object and field settings"
						variant="base"
						icon-name="utility:save"
						disabled={saveSettingsButtonDisabled}
						onclick={handleSaveSettingsButton}
					></lightning-button>
					<lightning-helptext
						content="Saves the object and field entries that you selected above so that you do not need to enter them again."
						icon-name="utility:info_alt"
					></lightning-helptext>
				</template>
				<template if:false={showSaveSettingsButton}>
					<lightning-button label="Clear saved object and field settings" variant="base" icon-name="utility:clear" onclick={handleClearSettingsButton}></lightning-button>
					<lightning-helptext
						content="Clear the object and field entries you previously saved and re-activate the object and field selectors above."
						icon-name="utility:info_alt"
					></lightning-helptext>
				</template>
			</div>
		</lightning-layout-item>
		<lightning-layout-item size="6" padding="around-medium">
			<lightning-input
				type="datetime"
				date-style="long"
				value={dateOfDemo}
				onchange={handleDateChange}
				label="Choose a Date and Time for Your Demo or Dry Run"
			></lightning-input>
			<template if:true={shiftAmountVisible}>
				<lightning-layout horizontal-align="spread" vertical-align="center" class="slds-p-top_medium">
					<lightning-layout-item size="5">
						<div class="slds-box slds-text-align_center slds-p-around_none">
							<div class="slds-p-vertical_xx-small">
								<strong>
									<lightning-formatted-number value={returnedMinutes} class="slds-text-heading_large slds-text-color_destructive"></lightning-formatted-number>
								</strong>
							</div>
							<div class="slds-theme_shade slds-p-vertical_xxx-small">
								Minutes
							</div>
						</div>
					</lightning-layout-item>
					<lightning-layout-item size="2">
						<div class="slds-align_absolute-center">
							or
						</div>
					</lightning-layout-item>
					<lightning-layout-item size="5">
						<div class="slds-box slds-text-align_center slds-p-around_none">
							<div class="slds-p-vertical_xx-small">
								<strong>
									<lightning-formatted-number value={returnedDays} class="slds-text-heading_large slds-text-color_destructive"></lightning-formatted-number>
								</strong>
							</div>
							<div class="slds-theme_shade slds-p-vertical_xxx-small">
								Days
							</div>
						</div>
					</lightning-layout-item>
				</lightning-layout>
			</template>
		</lightning-layout-item>
	</lightning-layout>
	<template if:true={shiftAmountVisible}>
		<div class="slds-p-horizontal_medium">
			<section class="slds-box slds-theme_shade">
				<p class="slds-text-title_caps slds-p-bottom_medium">
					Here is what will happen:
				</p>
				<p class="slds-p-bottom_small">
					<span>
						The difference between the most recent <code>{fieldApiName}</code> field of the <code>{objectApiName}</code> object in your org (<lightning-formatted-date-time
							value={mostRecent}
							year="numeric"
							day="2-digit"
							month="2-digit"
							hour="numeric"
							minute="2-digit"
						></lightning-formatted-date-time
						>) and the date and time you have selected (<lightning-formatted-date-time
							value={dateOfDemo}
							year="numeric"
							day="2-digit"
							month="2-digit"
							hour="numeric"
							minute="2-digit"
						></lightning-formatted-date-time
						>)
					</span>
					<span>
						is <strong> <lightning-formatted-number value={minutesToShift} class="slds-text-color_destructive"></lightning-formatted-number> </strong> minutes. So ...
					</span>
				</p>
				<ul class="slds-list_dotted">
					<li>
						All <code>DateTime</code> fields in all records for each of the objects in the list below will be shifted <strong> {forBack} </strong>
						<span>
							by&nbsp; <strong> <lightning-formatted-number value={minutesToShift} class="slds-text-color_destructive"></lightning-formatted-number> </strong> minutes.
						</span>
						<span>
							&nbsp;If the <strong> Adjust Minutes </strong> checkbox for the object is unchecked, then the <code>DateTime</code> fields will be shifted by the nearest number
							of whole days.
						</span>
					</li>
					<li>
						All <code>Date</code> fields in all records for each of the objects in the list below will be shifted <strong> {forBack} </strong>
						<span>
							by <strong> <lightning-formatted-number value={daysToShift} class="slds-text-color_destructive"></lightning-formatted-number> </strong> days.
						</span>
					</li>
					<li>
						If the <strong> Weekdays Only </strong> checkbox for the object is checked, then the shifted dates will be further adjusted so that they do not fall on weekends.
						If the shifted date falls on a Saturday, it will be further adjusted one whole day to fall on the previous Friday; if the shifted date falls on a Sunday, it will
						be further adjusted one whole day to fall on the following Monday.
					</li>
				</ul>
			</section>
		</div>
	</template>
</template>
